package detectcoll

import (
	"crypto/subtle"
	"testing"
)

func TestSHA1(t *testing.T) {
	var h Hash = NewSHA1()

	var ret []byte

	ret = h.Sum(nil)
	if subtle.ConstantTimeCompare(ret, []byte{0xda, 0x39, 0xa3, 0xee, 0x5e, 0x6b, 0x4b, 0x0d, 0x32, 0x55, 0xbf, 0xef, 0x95, 0x60, 0x18, 0x90, 0xaf, 0xd8, 0x07, 0x09}) != 1 {
		t.Errorf("Empty hash incorrect: %x", ret)
	}

	// h.Reset()
	h.Write([]byte("abc"))
	ret = h.Sum(nil)
	if subtle.ConstantTimeCompare(ret, []byte{0xA9, 0x99, 0x3E, 0x36, 0x47, 0x06, 0x81, 0x6A, 0xBA, 0x3E, 0x25, 0x71, 0x78, 0x50, 0xC2, 0x6C, 0x9C, 0xD0, 0xD8, 0x9D}) != 1 {
		t.Errorf("Hash('abc') incorrect: %x", ret)
	}

}

func TestSHA1Collisions(t *testing.T) {
	// Still working on this test case...
}
